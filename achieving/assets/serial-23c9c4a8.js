import{_ as V,r as c,o as E,E as o,a as n,c as f,b as e,w as a,d as v,e as i,u as D,t as L,f as R,g as p,s as T,p as $,h as q}from"./index-53aa3081.js";const y=l=>($("data-v-de822495"),l=l(),q(),l),z={class:"common-layout"},M={class:"left"},O=y(()=>i("h1",{style:{"margin-left":"10px"}},"串口管理系统",-1)),P=y(()=>i("div",{class:"right"},[i("h1",null,"个人信息")],-1)),j={key:0},A={__name:"serial",setup(l){const s=c(null),r=c(null),u=c(null),_=c(null),g={baudRate:9600,flowControl:"none",dataBits:8};E(()=>{"serial"in navigator||o({title:"浏览器版本低",message:"您的浏览器版本太低，可能不支持浏览器串口的使用",type:"error",duration:2e4})});const h=async()=>{try{s.value=await navigator.serial.requestPort(),console.log(s.value)}catch(t){o({title:"选择串口失败",message:"错误信息："+t,type:"warning",duration:2e3});return}o({title:"选择串口成功",message:"打开串口接收信息",type:"success",duration:2e3})},w=async()=>{try{await s.value.open(g),r.value=s.value.readable.getReader(),_.value=!0}catch(t){o({title:"打开串口失败",message:t,type:"warning",duration:2e3});return}o({title:"打开串口成功",message:"串口等待接收信息中",type:"success",duration:2e3}),x()},k=async()=>{try{await r.value.cancel(),await s.value.close(),_.value=!1}catch{o({title:"关闭串口失败",message:"请检查后重新关闭串口",type:"warning",duration:2e3});return}o({title:"关闭串口成功",message:`已关闭串口:${s.value.name}`,type:"success",duration:2e3})};async function x(){try{for(;_.value;){const{value:t,done:m}=await r.value.read();if(m){r.value.releaseLock();break}u.value=new TextDecoder().decode(t)}}catch(t){o({title:"读取串口失败",message:`串口读取信息失败：${t}`,type:"error",duration:2e3})}}return(t,m)=>{const C=n("el-icon"),S=n("el-header"),b=n("el-main"),d=n("el-button"),N=n("el-row"),B=n("el-footer"),I=n("el-container");return v(),f("div",z,[e(I,null,{default:a(()=>[e(S,null,{default:a(()=>[i("div",M,[e(C,{size:"30"},{default:a(()=>[e(D(T))]),_:1}),O]),P]),_:1}),e(b,null,{default:a(()=>[u.value?(v(),f("p",j,"接收到的信息: "+L(u.value),1)):R("",!0)]),_:1}),e(B,null,{default:a(()=>[e(N,null,{default:a(()=>[e(d,{onClick:h,type:"primary",round:""},{default:a(()=>[p("选择串口")]),_:1}),e(d,{onClick:w,type:"primary",round:""},{default:a(()=>[p("打开串口")]),_:1}),e(d,{onClick:k,type:"danger",round:""},{default:a(()=>[p("关闭串口")]),_:1})]),_:1})]),_:1})]),_:1})])}}},G=V(A,[["__scopeId","data-v-de822495"]]);export{G as default};
